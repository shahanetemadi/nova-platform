<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NOVA | The Future of Web3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

<style>
:root{
  --neon:#4efcff;
  --bg1:#050b1e;
  --bg2:#020617;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter, sans-serif;
  background:radial-gradient(circle at top,var(--bg1),var(--bg2));
  color:#fff;
  overflow-x:hidden;
}
canvas{
  position:fixed;
  inset:0;
  z-index:-1;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px;
}
.logo{
  font-family:Orbitron;
  font-size:26px;
  letter-spacing:3px;
  color:var(--neon);
}
.btn{
  padding:12px 22px;
  border-radius:30px;
  border:1px solid var(--neon);
  background:transparent;
  color:var(--neon);
  cursor:pointer;
  transition:.3s;
}
.btn:hover{background:var(--neon);color:#000}
.hero{
  min-height:90vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:20px;
}
.hero h1{
  font-family:Orbitron;
  font-size:44px;
  margin-bottom:10px;
}
.hero p{opacity:.8;max-width:600px}
.section{
  padding:80px 20px;
  max-width:1100px;
  margin:auto;
}
.card{
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.08);
  border-radius:20px;
  padding:25px;
  margin-bottom:20px;
  backdrop-filter:blur(10px);
}
.hidden{display:none}
.lang{
  margin-right:10px;
}
.stat{
  color:var(--neon);
  font-weight:600;
}
input{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:12px;
  border:none;
  outline:none;
}
footer{
  text-align:center;
  padding:30px;
  opacity:.5;
}
</style>
</head>

<body>

<canvas id="stars"></canvas>

<header>
  <div class="logo">NOVA</div>
  <div>
    <button class="btn lang" onclick="setLang('en')">EN</button>
    <button class="btn lang" onclick="setLang('fa')">FA</button>
    <button class="btn" onclick="connectWallet()">Connect Wallet</button>
  </div>
</header>

<section class="hero">
  <h1 id="title">THE FUTURE OF WEB3</h1>
  <p id="subtitle">A decentralized galaxy-powered platform on BSC</p>
  <br>
  <button class="btn" onclick="signLogin()">Sign to Enter</button>
  <p id="walletStatus"></p>
</section>

<section id="dashboard" class="section hidden">
  <div class="card">
    <h2>User Dashboard</h2>
    <p>Wallet: <span class="stat" id="walletAddr"></span></p>
    <p>User Count: <span class="stat" id="userCount"></span></p>
  </div>

  <div class="card">
    <h3>Actions</h3>
    <input id="username" placeholder="Username">
    <button class="btn" onclick="register()">Register</button>
    <br><br>
    <input id="amount" placeholder="Amount (ETH)">
    <button class="btn" onclick="purchase()">Purchase</button>
    <br><br>
    <button class="btn" onclick="withdraw()">Withdraw</button>
  </div>
</section>

<footer>
  © NOVA — Web3 Galaxy
</footer>

<script>
// ===== STAR BACKGROUND =====
const c=document.getElementById("stars"),ctx=c.getContext("2d");
let w,h,stars=[];
function resize(){w=c.width=innerWidth;h=c.height=innerHeight}
window.onresize=resize;resize();
for(let i=0;i<200;i++)stars.push({x:Math.random()*w,y:Math.random()*h,z:Math.random()*2});
function anim(){
  ctx.clearRect(0,0,w,h);
  stars.forEach(s=>{
    s.y+=s.z;
    if(s.y>h)s.y=0;
    ctx.fillStyle="#4efcff";
    ctx.fillRect(s.x,s.y,1.5,1.5);
  });
  requestAnimationFrame(anim);
}
anim();

// ===== WEB3 =====
const CONTRACT="0x3810099D2D61e0399d07a3bad4e796A3De82ff27";
const ABI=[{"inputs":[],"name":"userCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"username","type":"string"}],"name":"register","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}];

let provider,signer,contract,address;

async function connectWallet(){
  if(window.ethereum) provider=window.ethereum;
  else if(window.safepal) provider=window.safepal.ethereum;
  else return alert("Open inside wallet browser");

  await provider.request({method:"eth_requestAccounts"});
  provider=new ethers.providers.Web3Provider(provider);
  signer=provider.getSigner();
  address=await signer.getAddress();
  document.getElementById("walletStatus").innerText="Connected: "+address;
}

async function signLogin(){
  if(!signer)return alert("Connect wallet first");
  const msg="Login to NOVA";
  await signer.signMessage(msg);
  localStorage.setItem("nova_signed","1");
  initApp();
}

async function initApp(){
  if(!localStorage.getItem("nova_signed"))return;
  document.getElementById("dashboard").classList.remove("hidden");
  document.getElementById("walletAddr").innerText=address;
  contract=new ethers.Contract(CONTRACT,ABI,signer);
  document.getElementById("userCount").innerText=await contract.userCount();
}

async function register(){
  await contract.register(document.getElementById("username").value);
}
async function purchase(){alert("Purchase ready – ABI expandable")}
async function withdraw(){await contract.withdraw()}

// ===== LANG =====
function setLang(l){
  if(l==="fa"){
    document.getElementById("title").innerText="آینده وب۳";
    document.getElementById("subtitle").innerText="پلتفرم غیرمتمرکز کهکشانی روی BSC";
  }else{
    document.getElementById("title").innerText="THE FUTURE OF WEB3";
    document.getElementById("subtitle").innerText="A decentralized galaxy-powered platform on BSC";
  }
}
</script>

</body>
</html>
