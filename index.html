<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Nova Platform</title>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>

<body>

<h2>Nova Platform – FINAL</h2>

<button onclick="connectWallet()">Connect Wallet</button>
<div id="walletStatus" style="margin-top:10px;color:green;"></div>

<script>
let provider, signer, userAddress;

async function connectWallet() {
  try {
    let ethProvider = null;

    if (window.ethereum) {
      ethProvider = window.ethereum;
    } else if (window.safepal && window.safepal.ethereum) {
      ethProvider = window.safepal.ethereum;
    } else if (window.BinanceChain) {
      ethProvider = window.BinanceChain;
    } else {
      alert("❌ فقط از داخل SafePal → Discover باز کن");
      return;
    }

    provider = new ethers.providers.Web3Provider(ethProvider, "any");
    await provider.send("eth_requestAccounts", []);

    signer = provider.getSigner();
    userAddress = await signer.getAddress();

    document.getElementById("walletStatus").innerText =
      "✅ Connected: " + userAddress.slice(0,6) + "..." + userAddress.slice(-4);

  } catch (err) {
    console.error(err);
    alert("❌ اتصال کنسل شد");
  }
}
</script>

</body>
</html>
